<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check-in da Visita - Sistema de Visitas</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/checkin-simples.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <h1>CHECK-IN DA VISITA</h1>
            </div>
            <div class="header-right">
                <span class="user-info">
                    Ol√°, <span id="userName">Usu√°rio</span>
                </span>
                <a href="../relatorios.html" id="relatoriosLink" style="display: none;">Relat√≥rios</a>
                <button onclick="history.back()" style="padding:8px 12px; border:1px solid #ccc; border-radius:6px; cursor:pointer;">
                    Voltar
                </button>
            </div>
        </div>
    </header>

    <div class="checkin-container">
        <!-- Informa√ß√µes da Visita -->
        <div class="visita-info">
            <h2>üìã INFORMA√á√ïES DA VISITA</h2>
            <div class="info-grid">
                <div class="info-item">
                    <label>Empresa:</label>
                    <span id="empresaNome">Carregando...</span>
                </div>
                <div class="info-item">
                    <label>Data da Visita:</label>
                    <span id="visitaData">Carregando...</span>
                </div>
                <div class="info-item">
                    <label>Consultor:</label>
                    <span id="consultorNome">Carregando...</span>
                </div>
                <div class="info-item">
                    <label>Tipo da Visita:</label>
                    <span id="tipoVisita">Carregando...</span>
                </div>
            </div>
        </div>

        <!-- Formul√°rio de Check-in -->
        <div class="checkin-form">
            <h2>‚úçÔ∏è RESUMO DA VISITA</h2>

            <div class="form-group">
                <label for="summary">RESUMO DA VISITA </label>
                <textarea
                    id="summary"
                    name="summary"
                    placeholder="Descreva o que aconteceu durante a visita, principais pontos discutidos, pr√≥ximos passos..."
                ></textarea>
            </div>

            <!-- Adicionando sele√ß√£o m√∫ltipla de motivos da visita -->
            <div class="form-group">
                <label>MOTIVOS DA VISITA *</label>
                <div class="motivos-container">
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="prospeccao">
                        Cliente buscando novo fornecedor; j√° √© atendido por concorrente
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="indicacao">
                        Cliente vindo por indica√ß√£o; estamos em negocia√ß√£o; alta probabilidade de fechamento
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="custo_beneficio">
                        Cliente buscando custo-benef√≠cio
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="reativacao">
                        J√° foi cliente Fortcal, passou a comprar outras marcas; objetivo √© reativa√ß√£o
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="manutencao">
                        Cliente ativo; visita de manuten√ß√£o de relacionamento
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="inadimplencia">
                        Cliente com hist√≥rico de inadimpl√™ncia; visita de ajuste e negocia√ß√£o
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="pos_venda">
                        Acompanhamento de lavoura com produtos Fortcal aplicados (p√≥s-venda t√©cnico)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="testemunha">
                        Acompanhamento de √°reas testemunha / compara√ß√£o com concorrentes
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="evento">
                        Convite para evento t√©cnico / dia de campo
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="suporte_tecnico">
                        Cliente buscando suporte t√©cnico para revenda/distribuidor
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="motivo" value="outros" id="motivoOutros">
                        Outros
                    </label>
                </div>

                <!-- Campo de descri√ß√£o para "Outros" -->
                <div id="motivoOutrosDescricao" style="display: none; margin-top: 10px;">
                    <label for="motivoOutrosTexto">DESCRI√á√ÉO (OBRIGAT√ìRIO) *</label>
                    <textarea
                        id="motivoOutrosTexto"
                        name="motivo_outros_texto"
                        rows="3"
                        placeholder="Descreva o motivo da visita..."
                    ></textarea>
                </div>
            </div>

            <!-- Campos condicionais para VISITA T√âCNICA -->
            <div id="camposTecnicos" style="display: none;">
                <div class="form-group">
                    <label for="propriedade">PROPRIEDADE / PROPRIET√ÅRIO *</label>
                    <input
                        type="text"
                        id="propriedade"
                        name="propriedade"
                        placeholder="Nome da propriedade ou propriet√°rio..."
                    >
                </div>

                <div class="form-group">
                    <label for="objetivosTecnicos">PRINCIPAIS OBJETIVOS *</label>
                    <textarea
                        id="objetivosTecnicos"
                        name="objetivos_tecnicos"
                        rows="3"
                        placeholder="Descreva os principais objetivos da visita t√©cnica..."
                    ></textarea>
                </div>

                <div class="form-group">
                    <label for="observacoesTecnicas">OBSERVA√á√ïES GERAIS</label>
                    <textarea
                        id="observacoesTecnicas"
                        name="observacoes_tecnicas"
                        rows="3"
                        placeholder="Observa√ß√µes adicionais sobre a visita t√©cnica..."
                    ></textarea>
                </div>
            </div>

            <div class="form-group">
                <label for="opportunity">GEROU OPORTUNIDADE COMERCIAL *</label>
                <select id="opportunity" name="opportunity" class="form-select" required>
                    <option value="">Selecione...</option>
                    <option value="0">N√ÉO</option>
                    <option value="1">SIM</option>
                </select>
            </div>

            <!-- NOVOS CAMPOS DE NEGOCIA√á√ÉO -->
            <div class="form-group">
                <label for="negociacao">HOUVE NEGOCIA√á√ÉO *</label>
                <select id="negociacao" name="negociacao" class="form-select" required>
                    <option value="">Selecione...</option>
                    <option value="0">N√ÉO</option>
                    <option value="1">SIM</option>
                </select>
            </div>

            <div class="form-group">
                <label for="termometro">TERM√îMETRO DE NEGOCIA√á√ÉO (1 a 10)</label>
                <div class="termometro-container">
                    <input
                        type="range"
                        id="termometro"
                        name="termometro"
                        min="1"
                        max="10"
                        value="5"
                        class="termometro-slider"
                    >
                    <div class="termometro-display">
                        <span class="termometro-value" id="termometroValue">5</span>
                        <span class="termometro-label">/ 10</span>
                    </div>
                </div>
                <div class="termometro-labels">
                    <span class="label-left">1 - Muito Baixo</span>
                    <span class="label-right">10 - Muito Alto</span>
                </div>
            </div>

            <div class="form-group">
                <label for="attachment">ANEXAR ARQUIVO (OPCIONAL)</label>
                <input
                    type="file"
                    id="attachment"
                    name="attachment"
                    accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt"
                    class="file-input"
                >
                <small class="file-help">FORMATOS ACEITOS: IMAGENS, PDF, DOC, XLS, TXT (M√ÅXIMO 5MB)</small>
            </div>
        </div>

        <!-- A√ß√µes do Formul√°rio (Modo Edi√ß√£o) -->
        <div class="form-actions" id="formActions">
            <button type="button" class="btn-secondary" onclick="cancelarCheckin()">
                CANCELAR
            </button>
            <button type="button" class="btn-warning" onclick="salvarRascunho()">
                SALVAR RASCUNHO
            </button>
            <button type="button" class="btn-success" onclick="concluirCheckin()">
                CONCLUIR CHECK-IN
            </button>
        </div>

        <!-- A√ß√µes do Modo Readonly -->
        <div class="readonly-actions" id="readonlyActions" style="display: none;">
            <div class="readonly-actions-container">
                <button type="button" class="btn-secondary" onclick="voltarParaVisitas()">
                    <span class="icon-back"></span> VOLTAR
                </button>
                <button type="button" class="btn-primary" onclick="copiarDados()">
                    <span class="icon-copy"></span> COPIAR DADOS
                </button>
                <button type="button" class="btn-info" id="btnBaixarAnexo" onclick="baixarAnexo()" style="display: none;">
                    <span class="icon-attachment"></span> BAIXAR ANEXO
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/checkin-simples.js"></script>
</body>
</html>
